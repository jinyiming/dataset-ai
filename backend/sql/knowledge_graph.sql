-- 用户和组织数据查询
SELECT_USER_ORG = """
SELECT DISTINCT 
    u."USER_NO", u."USER_NAME", 
    o."ORG_NO", o."ORG_NAME",
    r."SYSTEM_NO", r."SYSTEM_NAME"
FROM "XYCS"."UMS_USER" u
JOIN "XYCS"."UMS_USER_ORG_RELATE" uor ON u."USER_NO" = uor."USER_NO"
JOIN "XYCS"."UMS_ORG" o ON uor."ORG_NO" = o."ORG_NO"
LEFT JOIN "XYCS"."RMS_SYSTEM" r ON o."SYSTEM_NO" = r."SYSTEM_NO"
WHERE ROWNUM <= 20
"""

-- 发文数据查询
SELECT_DISPATCH = """
SELECT 
    d."ID", d."SUBJECT", d."DOC_TYPE",
    d."DRAFT_USER_NO", d."ATDO_READER"
FROM "XYCS"."EGOV_DISPATCH" d
WHERE d."DRAFT_USER_NO" IS NOT NULL
"""

-- 收文数据查询
SELECT_RECEIVAL = """
SELECT 
    r."ID", r."SUBJECT", r."DOC_TYPE",
    r."DRAFT_USER_NO", r."ATDO_READER"
FROM "XYCS"."EGOV_RECEIVAL" r
WHERE r."DRAFT_USER_NO" IS NOT NULL
"""

-- 意见数据查询
SELECT_OPINION = """
SELECT DISTINCT
    o."ID", 
    DBMS_LOB.SUBSTR(o."OPINION_CONTENT", 4000, 1) as "OPINION_CONTENT",
    o."DOC_ID",
    o."OPINION_USER_NO", 
    o."CREATE_TIME"
FROM "XYCS"."EGOV_OPINION" o
WHERE EXISTS (
    SELECT 1 
    FROM (
        SELECT "ID", "ATDO_READER"
        FROM "XYCS"."EGOV_DISPATCH"
        UNION ALL
        SELECT "ID", "ATDO_READER"
        FROM "XYCS"."EGOV_RECEIVAL"
    ) docs
    WHERE docs."ID" = o."DOC_ID"
    AND docs."ATDO_READER" LIKE '%' || o."OPINION_USER_NO" || '%'
)
AND o."OPINION_USER_NO" IS NOT NULL
AND o."DOC_ID" IS NOT NULL
AND o."OPINION_CONTENT" IS NOT NULL
""" 